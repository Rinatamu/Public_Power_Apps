# リモート出退勤報告アプリ

# 1. 前提条件

本アプリを使用する際は、使用する方全員に対し、以下のいずれかに該当するライセンスが必要となります。

* Microsoft 365 Business Basic 以上
* Office 365 E1 以上

# 2. Share Point環境の構築

本アプリのデータソースには、Share Point リストを使用しています。
そのため、まずはShare Point のリストを作成する必要があります。
本作業を行うには、環境によって管理権限が必要となる場合がありますので、その際は環境の管理者にその旨ご相談ください。

## 2.1 Share Point サイトの作成

1. トップメニューより Share Point を起動する。

![](pasteimage/2020-06-16-17-40-29.png)

2. サイトの作成をクリックする。

![](pasteimage/2020-06-16-17-42-19.png)

3. 作りたいサイトを選択し、クリックする。（本資料ではコミュニケーションサイトを前提とする）

![](pasteimage/2020-06-16-17-43-25.png)

4. 任意のサイト名などを入力し、完了をクリックする。

![](pasteimage/2020-06-16-17-45-30.png)

5. サイトが作成される

![](pasteimage/2020-06-16-17-46-21.png)

## 2.2 Share Point リストを作成する

1. サイト コンテンツをクリックする

![](pasteimage/2020-06-16-17-47-27.png)

2. 新規からリストをクリックする

![](pasteimage/2020-06-16-17-48-09.png)

3. リスト名を SYS_TBL_Work_InOut_log `とし、サイトナビゲーションに表示のチェックを無効化して作成をクリックする

![](pasteimage/2020-06-16-17-54-55.png)

4. リストが作成される
![](pasteimage/2020-06-16-18-03-40.png)

5. 同様に、SYS_TBL_Work_InOut_Temp_log も作成する。

![](pasteimage/2020-06-16-18-05-41.png)

## 2.3 SYS_TBL_Work_InOut_log の設定変更

SYS_TBL_Work_InOut_log のリスト構造はこのようになっています

|列名|種類|必須|選択値|既定値|
|:--|:--|:--|:--|:--|
|Full_Name|1行テキスト|True|||
|Work_Status|選択肢|True|出勤・休憩開始・休憩完了・退勤|出勤|
|Latitude|数値|True|||
|Longitude|数値|True|||
|Add_Day|1行テキスト|True|||

1. SYS_TBL_Work_InOut_logを開き、設定からリストの設定をクリック

![](pasteimage/2020-06-16-18-14-38.png)

2. 列からタイトルをクリック
![](pasteimage/2020-06-16-23-07-38.png)

3. 列名をタイトルからFull_Nameに変更し、OKをクリックする。
![](pasteimage/2020-06-16-23-11-18.png)

### 2.3.1 Work_Status 列の作成

1. 列の作成をクリックする。
![](pasteimage/2020-06-16-23-19-39.png)

2. 列名をWork_Statusにする
![](pasteimage/2020-06-16-23-22-31.png)

3. この列の情報を種類を「選択肢」に変更する
![](pasteimage/2020-06-16-23-23-49.png)

4. この列への情報の入力を必須にするを有効化する。
![](pasteimage/2020-06-16-23-25-07.png)

5. 選択肢を以下のように入力する
![](pasteimage/2020-06-16-23-26-15.png)

6. 選択肢の表示形式をドロップダウンメニューに変更する。
![](pasteimage/2020-06-16-23-27-40.png)

7. 選択肢を追加できないように設定する。
![](pasteimage/2020-06-16-23-28-27.png)

8. 既定値を「出勤」に設定する。
![](pasteimage/2020-06-16-23-32-09.png)

9. OKをクリックする。

同様に、他の列も作成し、以下のようになっていることを確認する。
![](pasteimage/2020-06-16-23-38-25.png)

## 2.4 SYS_TBL_Work_InOut_Temp_log の設定変更

SYS_TBL_Work_InOut_Temp_log のリスト構造はこのようになっています

|列名|種類|必須|選択値|既定値|
|:--|:--|:--|:--|:--|
|Full_Name|1行テキスト|True|||
|Temperature|数値|True|||
|Latitude|数値|True|||
|Longitude|数値|True|||
|Add_Day|1行テキスト|True|||

2.3. と同様に変更を行い、以下のように設定する。
![](pasteimage/2020-06-16-23-47-59.png)

# 3. Power Apps のインポート

1. メインメニューから Power Apps をクリックする。
![](pasteimage/2020-06-16-23-49-27.png)

2. アプリをクリックする。
![](pasteimage/2020-06-16-23-50-52.png)

3. キャンパスアプリのインポートをクリックする。
![](pasteimage/2020-06-16-23-51-31.png)

4. インポートするファイルに、GitHubからダウンロードした PowerApps_WorkInOut.zip をアップロードする。
![](pasteimage/2020-06-16-23-55-29.png)

5. インポートをクリックする。
![](pasteimage/2020-06-16-23-57-15.png)

# 4. 出退勤アプリの修正

1. ホームに戻り、出退勤報告アプリから編集をクリックする
![](pasteimage/2020-06-17-00-01-46.png)

2. 使用許可を求められるため、許可をクリックする。
![](pasteimage/2020-06-17-00-10-00.png)

3. このような画面が表示される。（ポップアップが表示されたら全て消す。）
（ブラウザの位置情報警告通知は許可するこ）
![](pasteimage/2020-06-17-00-11-32.png)

4. データソースを開き、赤色で示した部分を削除する。
![](pasteimage/2020-06-17-00-13-50.png)

5. データソースの検索ボックスにてSharePointと入力する。
![](pasteimage/2020-06-17-00-15-44.png)

6. データソースの候補が表示されるので、赤枠で示したアイコンのものをクリックする。
![](pasteimage/2020-06-17-00-16-32.png)

7. SharePointをクリックする
![](pasteimage/2020-06-17-00-17-23.png)

8. 作成していたサイトをクリックする
![](pasteimage/2020-06-17-00-18-25.png)

9. 作成したリストをチェックし、「接続」をクリックする。
![](pasteimage/2020-06-17-00-19-42.png)

10. ファイルから保存をクリックする。
![](pasteimage/2020-06-17-00-20-34.png)

11. 発行をクリックする。
![](pasteimage/2020-06-17-00-21-40.png)

